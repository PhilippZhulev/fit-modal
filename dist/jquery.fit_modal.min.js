!function(a){jQuery.fn.fit_modal=function(b){b=a.extend({modal_frame:".modal__frame",modal_window:".modal__window",modal_body:".modal__window__body",modal_title_class:".modal__window__title",modal_title:"Modal window",modal_content_block:null,frame_animation_speed:200,win_animation_speed:500,window_animation_type:"fade_in_top",modal_close:".modal__window__close",fast_create:!0,init_custom_func:null,active_custom_func:null,close_custom_func:null,window_style:{},frame_style:{},on_ajax_mod:!1,ajax_mod:{href:null,post_type:"GET",data:null,error_message:"Server error or page not found.",success_custom_func:null,error_custom_func:null},close_on_bg:!0,responsive_mod:{media:0,on_custom:null,off_custom:null,custom_func:null},fix_fw_el:null,fix_right_el:null,set_blur:null},b);var c=b.modal_frame,d=b.modal_window,e=function(){function e(a){return a.slice(1)}function f(a){return p.parents(a).length>0&&(q.idClass="."+q.allContent.first().attr(q.attrIndex)),p.parents(a).addClass(e(q.idClass))}function g(a,b){return a.addClass(b)}function h(a,b){return a.removeClass(b)}function i(a,b){return a.css("transition","all "+b+"ms")}function j(c){var d=b.set_blur,e=a(d);if(null!==d)return 1===c&&"init"!==c?(e.css("transition","all "+b.frame_animation_speed+"ms"),e.addClass(q.blurClass)):(e.removeAttr("style"),e.removeClass(q.blurClass))}function k(a){return e(a).replace("."," ")}function l(){function c(){h(v,q.activeClass),z.removeClass(q.activeClass).removeAttr("style"),a(b.fix_fw_el+","+b.fix_right_el).removeAttr("style"),j(0),clearTimeout(d),n.trigger("fm.onCloseFrame")}h(w,q.activeClass),null!==b.close_custom_func&&b.close_custom_func(n,q);var d=setTimeout(c,b.win_animation_speed);n.trigger("fm.onClose")}function m(){a(window).width()<B.media?(g(b.modal_window,"modal__responsive"),n.trigger("fm.onResponsive"),void 0!==B.on_custom&&B.on_custom(n,q)):(h(w,"modal__responsive"),n.trigger("fm.offResponsive"),void 0!==B.off_custom&&B.off_custom(n,q)),void 0!==B.custom_func&&B.custom_func(n,q)}var n=a(this);b.modal_frame=c,b.modal_window=d;var o=n.attr("data-content_block");o&&(b.modal_content_block=o);var p=a(b.modal_content_block);p.addClass("modal__content");var q=a.data(n,"fit_modal",{idClass:".fm_"+function(a,b){return Math.floor(Math.random()*(b-a))+a}(135,72354e3),contentClass:"modal__content",allContent:p.parent().find(".modal__content"),attrIndex:"data-index",blurClass:"fit__blur",activeClass:"fit_modal_open",loader:"fit_modal__load"});void 0===q.allContent.attr(q.attrIndex)&&q.allContent.attr(q.attrIndex,e(q.idClass)),f(b.modal_frame),f(b.modal_window),b.modal_frame+=q.idClass,b.modal_window+=q.idClass;var r=document.createElement("div");r.className="scroll-bar__measure",document.body.appendChild(r);var s=r.offsetWidth-r.clientWidth;document.body.removeChild(r);var t=function(){a(b.modal_body).children().hide()},u=n.attr("data-win-animation");j("init"),!0===b.fast_create&&a(b.modal_frame).length<1&&p.wrapAll('<div class="'+k(b.modal_frame)+'"><div class="'+k(b.modal_window)+'"><div class="'+k(b.modal_body)+'">').parents(b.modal_window).prepend('<div class="modal__window__header"><div class="'+k(b.modal_close)+'"></div><div class="'+k(b.modal_title_class)+'"></div></div>'),t();var v=a(b.modal_frame),w=a(b.modal_window),x=n.attr("data-title"),y=a(b.modal_title_class),z=a("html");void 0!==u&&(b.window_animation_type=u);var A="fit_"+b.window_animation_type;if(w.filter(q.idClass).attr("class").indexOf("fit_")+1===0&&g(w,A),v.css(b.frame_style),w.css(b.window_style),null!==b.init_custom_func&&b.init_custom_func(n,q),n.on("click on.modal.active",function(c){function d(){g(w,q.activeClass),i(w,b.win_animation_speed),clearTimeout(f),n.trigger("fm.onWindow")}function e(){f=setTimeout(d,b.frame_animation_speed)}c.preventDefault(),t(),j(1),z.height()<=a(window).height()&&(s=0),x?y.html(x):y.html(b.modal_title),p.show(),i(v,b.frame_animation_speed),g(v,q.activeClass),z.addClass(q.activeClass),z.css("padding-right",s),null!==b.fix_fw_el&&a(b.fix_fw_el).css({"padding-right":s}),null!==b.fix_right_el&&a(b.fix_right_el).css({"margin-right":s});var f;if(null!==b.active_custom_func&&b.active_custom_func(n,q),!0===b.on_ajax_mod){var h=b.ajax_mod,k=n.attr("data-href");k&&(h.href=k);var l=q.loader,m=a("."+l);a.ajax({url:h.href,type:h.post_type,data:h.data,async:!0,beforeSend:function(){v.append('<div class="'+l+'"></div>')},success:function(a){p.load(k,function(){m.remove(),e()}),null!==h.success_custom_func&&h.success_custom_func(n,q,a)},error:function(a){p.html(h.error_message),m.remove(),e(),null!==h.error_custom_func&&h.error_custom_func(n,q,a)}})}else e();return n.trigger("fm.onActive"),!0}),a(b.modal_close).on("click on.modal.close",function(){l()}),!0===b.close_on_bg&&v.click(function(a){w.is(a.target)||0!==w.has(a.target).length||l()}),0!==b.responsive_mod.media){var B=b.responsive_mod;m(),a(window).resize(m)}};return this.each(e)}}(jQuery);