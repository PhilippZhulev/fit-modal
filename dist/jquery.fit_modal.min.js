!function(a){jQuery.fn.fit_modal=function(b){b=a.extend({modal_frame:".modal__frame",modal_window:".modal__window",modal_body:".modal__window__body",modal_title_class:".modal__window__title",modal_title:"Modal window",modal_content_block:null,frame_animation_speed:200,win_animation_speed:500,window_animation_type:"fade_in_top",modal_close:".modal__window__close",fast_create:!0,init_custom_func:null,active_custom_func:null,close_custom_func:null,window_style:{},frame_style:{},on_ajax_mod:!1,ajax_mod:{href:null,post_type:"GET",data:null,error_message:"Server error or page not found.",success_custom_func:null,error_custom_func:null},close_on_bg:!0,responsive_mod:{media:0,on_custom:null,off_custom:null,custom_func:null},fix_fw_el:null,fix_right_el:null,set_blur:null},b);var c=function(){function c(a){return a.slice(1)}function d(a){return n.parents(a).length>0&&(o.idClass="."+o.allContent.first().attr(o.attrIndex)),n.parents(a).addClass(c(o.idClass))}function e(b,c){a(b+o.idClass).addClass(c)}function f(b,c){a(b+o.idClass).removeClass(c)}function g(b,c){a(o.idClass).css("transition","all "+c+"ms")}function h(c){var d=b.set_blur,e=a(d);if(null!==d)return 1===c&&"init"!==c?(e.css("transition","all "+b.frame_animation_speed+"ms"),e.addClass(o.blurClass)):(e.removeAttr("style"),e.removeClass(o.blurClass))}function i(a){return c(a).replace("."," ")}function j(){function c(){f(b.modal_frame,o.activeClass),x.removeClass(o.activeClass).removeAttr("style"),a(b.fix_fw_el+","+b.fix_right_el).removeAttr("style"),h(0),clearTimeout(d),l.trigger("fm.onCloseFrame")}f(b.modal_window,o.activeClass),null!==b.close_custom_func&&b.close_custom_func(l,o);var d=setTimeout(c,b.win_animation_speed);l.trigger("fm.onClose")}function k(){a(window).width()<y.media?(e(b.modal_window,"modal__responsive"),l.trigger("fm.onResponsive"),void 0!==y.on_custom&&y.on_custom(l,o)):(f(b.modal_window,"modal__responsive"),l.trigger("fm.offResponsive"),void 0!==y.off_custom&&y.off_custom(l,o)),void 0!==y.custom_func&&y.custom_func(l,o)}var l=a(this),m=l.attr("data-content_block");m&&(b.modal_content_block=m);var n=a(b.modal_content_block),o=a.data(l,"fit_modal",{idClass:".fm_"+function(a,b){return Math.floor(Math.random()*(b-a))+a}(135,1235e3),allContent:n.parent().children(),attrIndex:"data-index",blurClass:"fit__blur",activeClass:"fit_modal_open",loader:"fit_modal__load"});void 0===n.attr(o.attrIndex)&&o.allContent.attr(o.attrIndex,c(o.idClass)),d(b.modal_frame),d(b.modal_window),b.modal_frame+=o.idClass,b.modal_window+=o.idClass;var p=document.createElement("div");p.className="scroll-bar__measure",document.body.appendChild(p);var q=p.offsetWidth-p.clientWidth;document.body.removeChild(p);var r=function(){a(b.modal_body).children().hide()},s=l.attr("data-win-animation");h("init"),!0===b.fast_create&&a(b.modal_frame).length<1&&n.wrapAll('<div class="'+i(b.modal_frame)+'"><div class="'+i(b.modal_window)+'"><div class="'+i(b.modal_body)+'">').parents(b.modal_window).prepend('<div class="modal__window__header"><div class="'+i(b.modal_close)+'"></div><div class="'+i(b.modal_title_class)+'"></div></div>'),r(),s?e(b.modal_window,"fit_"+s):e(b.modal_window,"fit_"+b.window_animation_type);var t=a(b.modal_frame),u=a(b.modal_window),v=l.attr("data-title"),w=a(b.modal_title_class),x=a("html");if(t.css(b.frame_style),u.css(b.window_style),null!==b.init_custom_func&&b.init_custom_func(l,o),l.on("click on.modal.active",function(c){function d(){e(b.modal_window,o.activeClass),g(u,b.win_animation_speed),clearTimeout(i),l.trigger("fm.onWindow")}function f(){i=setTimeout(d,b.frame_animation_speed)}c.preventDefault(),r(),h(1),x.height()<=a(window).height()&&(q=0),v?w.html(v):w.html(b.modal_title),n.show(),g(t,b.frame_animation_speed),e(b.modal_frame,o.activeClass),x.addClass(o.activeClass),x.css("padding-right",q),null!==b.fix_fw_el&&a(b.fix_fw_el).css({"padding-right":q}),null!==b.fix_right_el&&a(b.fix_right_el).css({"margin-right":q});var i;if(null!==b.active_custom_func&&b.active_custom_func(l,o),!0===b.on_ajax_mod){var j=b.ajax_mod,k=l.attr("data-href");k&&(j.href=k);var m=o.loader,p=a("."+m);a.ajax({url:j.href,type:j.post_type,data:j.data,async:!0,beforeSend:function(){t.append('<div class="'+m+'"></div>')},success:function(a){n.load(k,function(){p.remove(),f()}),null!==j.success_custom_func&&j.success_custom_func(l,o,a)},error:function(a){n.html(j.error_message),p.remove(),f(),null!==j.error_custom_func&&j.error_custom_func(l,o,a)}})}else f();return l.trigger("fm.onActive"),!0}),a(b.modal_close).on("click on.modal.close",function(){j()}),!0===b.close_on_bg&&t.click(function(a){u.is(a.target)||0!==u.has(a.target).length||j()}),0!==b.responsive_mod.media){var y=b.responsive_mod;k(),a(window).resize(k)}};return this.each(c)}}(jQuery);