!function(a){jQuery.fn.fit_modal=function(b){b=a.extend({modal_frame:".modal__frame",modal_window:".modal__window",modal_body:".modal__window__body",modal_title_class:".modal__window__title",modal_title:"Modal window",modal_content_block:null,frame_animation_speed:300,win_animation_speed:500,window_animation_type:"fade_in_top",modal_close:".modal__window__close",fast_create:!0,active_custom_func:null,close_custom_func:null,window_style:{},frame_style:{},on_ajax_mod:!1,ajax_mod:{href:null,post_type:"GET",data:null,error_message:"Server error or page not found.",success_custom_func:null,error_custom_func:null},close_on_bg:!0,responsive_mod:{media:0,on_custom:null,off_custom:null,custom_func:null},fix_fw_el:null,fix_right_el:null},b);var c=function(){function c(a){return a.slice(1)}function d(a){return n.parents(a).addClass(c(l))}function e(b,c){a(b+l).addClass(c)}function f(b,c){a(b+l).removeClass(c)}function g(b,c){a(b).css("transition","all "+c+"ms")}function h(a){return c(a).replace("."," ")}function i(){function c(){f(b.modal_frame,"fit_modal_open"),w.removeClass("fit_modal_open").removeAttr("style"),a(b.fix_fw_el+","+b.fix_right_el).removeAttr("style"),clearTimeout(d),k.trigger("fm.onCloseFrame")}f(b.modal_window,"fit_modal_open"),null!==b.close_custom_func&&b.close_custom_func(k,l);var d=setTimeout(c,b.win_animation_speed);k.trigger("fm.onClose")}function j(){a(window).width()<x.media?(e(b.modal_window,"modal__responsive"),k.trigger("fm.onResponsive"),void 0!==x.on_custom&&x.on_custom(k)):(f(b.modal_window,"modal__responsive"),k.trigger("fm.offResponsive"),void 0!==x.off_custom&&x.off_custom(k)),void 0!==x.custom_func&&x.custom_func(k)}var k=a(this),l=".fm_"+function(a,b){return Math.floor(Math.random()*(b-a))+a}(135,1235e3),m=k.attr("data-content_block");m&&(b.modal_content_block=m);var n=a(b.modal_content_block);d(b.modal_frame),d(b.modal_window),b.modal_frame+=l,b.modal_window+=l;var o=document.createElement("div");o.className="scroll-bar__measure",document.body.appendChild(o);var p=o.offsetWidth-o.clientWidth;document.body.removeChild(o);var q=function(){a(b.modal_body).children().hide()},r=k.attr("data-win-animation");!0===b.fast_create&&a(b.modal_frame).length<1&&a(n).wrapAll('<div class="'+h(b.modal_frame)+'"><div class="'+h(b.modal_window)+'"><div class="'+h(b.modal_body)+'">').parents(b.modal_window).prepend('<div class="modal__window__header"><div class="'+h(b.modal_close)+'"></div><div class="'+h(b.modal_title_class)+'"></div></div>'),q(),r?e(b.modal_window,"fit_"+r):e(b.modal_window,"fit_"+b.window_animation_type);var s=a(b.modal_frame),t=a(b.modal_window),u=k.attr("data-title"),v=a(b.modal_title_class),w=a("html");if(s.css(b.frame_style),t.css(b.window_style),k.on("click on.modal.active",function(c){function d(){e(b.modal_window,"fit_modal_open"),g(t,b.win_animation_speed),clearTimeout(h),k.trigger("fm.onWindow")}function f(){h=setTimeout(d,b.frame_animation_speed)}c.preventDefault(),q(),w.height()<=a(window).height()&&(p=0),u?v.html(u):v.html(b.modal_title),n.show(),g(s,b.frame_animation_speed),e(b.modal_frame,"fit_modal_open"),w.addClass("fit_modal_open"),w.css("padding-right",p),null!==b.fix_fw_el&&a(b.fix_fw_el).css({"padding-right":p}),null!==b.fix_right_el&&a(b.fix_right_el).css({"margin-right":p});var h;if(null!==b.active_custom_func&&b.active_custom_func(k,l),!0===b.on_ajax_mod){var i=b.ajax_mod,j=k.attr("data-href");j&&(i.href=j);var m=a(".fit_modal__load");a.ajax({url:i.href,type:i.post_type,data:i.data,async:!0,beforeSend:function(){s.append('<div class="fit_modal__load"></div>')},success:function(a){n.load(j,function(){m.remove(),f()}),null!==i.success_custom_func&&i.success_custom_func(k,a)},error:function(a){n.html(i.error_message),m.remove(),f(),null!==i.error_custom_func&&i.error_custom_func(k,a)}})}else f();return k.trigger("fm.onActive"),!0}),a(b.modal_close).on("click on.modal.close",function(){i()}),!0===b.close_on_bg&&s.click(function(a){t.is(a.target)||0!==t.has(a.target).length||i()}),0!==b.responsive_mod.media){var x=b.responsive_mod;j(),a(window).resize(j)}};return this.each(c)}}(jQuery);