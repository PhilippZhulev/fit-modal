!function(a){jQuery.fn.fit_modal=function(b){b=a.extend({modal_frame:".modal__frame",modal_window:".modal__window",modal_body:".modal__window__body",modal_title_class:".modal__window__title",modal_title:"Modal window",modal_content_block:null,frame_animation_speed:200,win_animation_speed:500,window_animation_type:"fade_in_top",modal_close:".modal__window__close",fast_create:!0,init_custom_func:null,active_custom_func:null,close_custom_func:null,window_style:{},frame_style:{},on_ajax_mod:!1,ajax_mod:{href:null,post_type:"GET",data:null,error_message:"Server error or page not found.",success_custom_func:null,error_custom_func:null},close_on_bg:!0,responsive_mod:{media:0,on_custom:null,off_custom:null,custom_func:null},fix_fw_el:null,fix_right_el:null,set_blur:null},b);var c=b.modal_frame,d=b.modal_window,e=function(){function e(a){return a.slice(1)}function f(a){return r.parents(a).length>0&&(s.idClass="."+s.allContent.first().attr(s.attrIndex)),r.parents(a).addClass(e(s.idClass))}function g(a,b){return a.addClass(b)}function h(a,b){return a.removeClass(b)}function i(a,b){return a.css("transition","all "+b+"ms")}function j(c){var d=b.set_blur,e=a(d);if(null!==d)return 1===c&&"init"!==c?(e.css("transition","all "+b.frame_animation_speed+"ms"),e.addClass(s.blurClass)):(e.removeAttr("style"),e.removeClass(s.blurClass))}function k(a){return e(a).replace("."," ")}function l(){g(y,s.activeClass),p.trigger("fm.onWindow")}function m(){h(y,s.activeClass),p.trigger("fm.onClose")}function n(){function c(){h(x,s.activeClass),B.removeClass(s.activeClass).removeAttr("style"),a(b.fix_fw_el+","+b.fix_right_el).removeAttr("style"),j(0),clearTimeout(d),p.trigger("fm.onCloseFrame")}m(),null!==b.close_custom_func&&b.close_custom_func(p,s);var d=setTimeout(c,b.win_animation_speed)}function o(){a(window).width()<D.media?(g(y,"modal__responsive"),p.trigger("fm.onResponsive"),void 0!==D.on_custom&&D.on_custom(p,s)):(h(y,"modal__responsive"),p.trigger("fm.offResponsive"),void 0!==D.off_custom&&D.off_custom(p,s)),void 0!==D.custom_func&&D.custom_func(p,s)}var p=a(this);b.modal_frame=c,b.modal_window=d;var q=p.attr("data-content_block");q&&(b.modal_content_block=q);var r=a(b.modal_content_block);r.addClass("modal__content");var s=a.data(p,"fit_modal",{idClass:".fm_"+function(a,b){return Math.floor(Math.random()*(b-a))+a}(135,72354e3),contentClass:"modal__content",allContent:r.parent().find(".modal__content"),attrIndex:"data-index",blurClass:"fit__blur",activeClass:"fit_modal_open",loader:"fit_modal__load"});void 0===s.allContent.attr(s.attrIndex)&&s.allContent.attr(s.attrIndex,e(s.idClass)),f(b.modal_frame),f(b.modal_window),b.modal_frame+=s.idClass,b.modal_window+=s.idClass;var t=document.createElement("div");t.className="scroll-bar__measure",document.body.appendChild(t);var u=t.offsetWidth-t.clientWidth;document.body.removeChild(t);var v=function(){a(b.modal_body).children().hide()},w=p.attr("data-win-animation");j("init"),!0===b.fast_create&&a(b.modal_frame).length<1&&r.wrapAll('<div class="'+k(b.modal_frame)+'"><div class="'+k(b.modal_window)+'"><div class="'+k(b.modal_body)+'">').parents(b.modal_window).prepend('<div class="modal__window__header"><div class="'+k(b.modal_close)+'"></div><div class="'+k(b.modal_title_class)+'"></div></div>'),v();var x=a(b.modal_frame),y=a(b.modal_window),z=p.attr("data-title"),A=a(b.modal_title_class),B=a("html");void 0!==w&&(b.window_animation_type=w);var C="fit_"+b.window_animation_type;if(y.filter(s.idClass).attr("class").indexOf("fit_")+1===0&&g(y,C),x.css(b.frame_style),y.css(b.window_style),null!==b.init_custom_func&&b.init_custom_func(p,s),p.on("on.win.active",l),p.on("click on.modal.active",function(c){function d(){l(),i(y,b.win_animation_speed),clearTimeout(f)}function e(){f=setTimeout(d,b.frame_animation_speed)}c.preventDefault(),v(),j(1),B.height()<=a(window).height()&&(u=0),z?A.html(z):A.html(b.modal_title),r.show(),i(x,b.frame_animation_speed),g(x,s.activeClass),B.addClass(s.activeClass),B.css("padding-right",u),null!==b.fix_fw_el&&a(b.fix_fw_el).css({"padding-right":u}),null!==b.fix_right_el&&a(b.fix_right_el).css({"margin-right":u});var f;if(null!==b.active_custom_func&&b.active_custom_func(p,s),!0===b.on_ajax_mod){var h=b.ajax_mod,k=p.attr("data-href");k&&(h.href=k);var m=s.loader,n=a("."+m);a.ajax({url:h.href,type:h.post_type,data:h.data,async:!0,beforeSend:function(){x.append('<div class="'+m+'"></div>')},success:function(b){r.load(k,function(){a("div").remove("."+m),e()}),null!==h.success_custom_func&&h.success_custom_func(p,s,b)},error:function(a){r.html(h.error_message),n.remove(),e(),null!==h.error_custom_func&&h.error_custom_func(p,s,a)}})}else e();return p.trigger("fm.onActive"),!0}),p.on("on.win.close",m),a(b.modal_close).on("click on.modal.close",function(){n()}),!0===b.close_on_bg&&x.click(function(a){y.is(a.target)||0!==y.has(a.target).length||n()}),0!==b.responsive_mod.media){var D=b.responsive_mod;o(),a(window).resize(o)}};return this.each(e)}}(jQuery);